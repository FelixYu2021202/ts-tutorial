var source = require('fs').readFileSync(require('path').join(process.cwd(), process.argv[2]), "utf8");

var Reflect = require("./reflect");
var b = require("reflect-builder").treeBuilder;
var transform = require("./transform").transform;

var ast = Reflect.parse(source, {builder: b});

transform(ast);

console.log(Reflect.stringify(ast));

Object.extend = function (a, b) {
    Object.getOwnPropertyNames(b).forEach(function (name) {
        var desc = Object.getOwnPropertyDescriptor(b, name);
        Object.defineProperty(a, name, desc);
    });
    return a;
};

eval(Reflect.stringify(ast));

